!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("szfe-tools/lib/flatten"),require("szfe-tools/lib/get"),require("szfe-tools/lib/run"),require("szfe-tools/lib/debounce"),require("react"),require("szfe-tools/lib/isFunction"),require("create-react-context"),require("szfe-tools/lib/EventBus"),require("szfe-tools/lib/nextTick"),require("react-dom"),require("szfe-tools/lib/isString"),require("szfe-tools/lib/isExist"),require("szfe-tools/lib/memoize"),require("szfe-tools/lib/isUndefined"),require("szfe-tools/lib/isObject"),require("hoist-non-react-statics"),require("szfe-tools/lib/value"),require("szfe-tools/lib/isArray"),require("szfe-tools/lib/globalThis"),require("react-node-key")):"function"==typeof define&&define.amd?define(["exports","szfe-tools/lib/flatten","szfe-tools/lib/get","szfe-tools/lib/run","szfe-tools/lib/debounce","react","szfe-tools/lib/isFunction","create-react-context","szfe-tools/lib/EventBus","szfe-tools/lib/nextTick","react-dom","szfe-tools/lib/isString","szfe-tools/lib/isExist","szfe-tools/lib/memoize","szfe-tools/lib/isUndefined","szfe-tools/lib/isObject","hoist-non-react-statics","szfe-tools/lib/value","szfe-tools/lib/isArray","szfe-tools/lib/globalThis","react-node-key"],t):t((e=e||self).ReactActivation={},e._flatten,e._get,e._run,e._debounce,e.React,e._isFunction,e.createContext$1,e._EventBus,e._nextTick,e.reactDom,e._isString,e._isExist,e._memoize,e._isUndefined,e._isObject,e.hoistStatics,e._value,e._isArray,e._globalThis,e.NodeKey)}(this,function(e,i,u,l,c,a,s,n,f,p,r,d,o,t,h,v,y,m,b,g,w){"use strict";i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c;var k="default"in a?a.default:a;function U(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?U(Object(n),!0).forEach(function(e){C(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,G(r.key),r)}}function O(e,t,n){t&&q(e.prototype,t),n&&q(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function C(e,t,n){return(t=G(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(){return(_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n,r=arguments[t];for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function P(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D(e,t)}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t){return(D=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(e,t){if(null==e)return{};var n,r=function(e,t){if(null==e)return{};for(var n,r={},o=Object.keys(e),c=0;c<o.length;c++)n=o[c],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),c=0;c<o.length;c++)n=o[c],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return x(e)}function z(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=R(n);return L(this,r?(e=R(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function M(e,t){return W(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,c,i,a=[],u=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=c.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return a}}(e,t)||K(e,t)||X()}function F(e){return W(e)||V(e)||K(e)||X()}function A(e){return function(e){if(Array.isArray(e))return H(e)}(e)||V(e)||K(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e){if(Array.isArray(e))return e}function V(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function K(e,t){var n;if(e)return"string"==typeof e?H(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H(e,t):void 0}function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function X(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function G(e){e=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if("object"!=typeof(n=n.call(e,t||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:String(e)}s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,d=d&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,h=h&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m,b=b&&Object.prototype.hasOwnProperty.call(b,"default")?b.default:b,g=g&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w;function Y(){var e,t,n;return s(a.useContext)?a.useContext(Z)||(t=(e=M(a.useState(ce.currentContextValue),2))[0],n=e[1],a.useEffect(function(){var e=c(n);return N.on("update",e),function(){return N.off("update",e)}},[]),t):{}}function J(e){var t=e.children,e=j(e,ae);return k.createElement(ee,_({},e,{_nk:"".concat(ue,"11")}),k.createElement(ce,_({},e,{_nk:"".concat(ue,"21")}),t))}function Q(e){var t=e.children;return k.createElement(te,{_nk:"".concat(ue,"31")},function(e){return e?l(t,void 0,e):k.createElement(ie,{_nk:"".concat(ue,"41")},t)})}var Z=n(),ee=Z.Provider,te=Z.Consumer,ne=n(),re=ne.Provider,oe=ne.Consumer,N=new f,ce=function(){P(r,a.Component);var n=z(r);function r(e){var t;return E(this,r),t=n.call(this,e),r.currentContextValue=e.value,t}return O(r,[{key:"shouldComponentUpdate",value:function(e){return e.value!==this.props.value&&(r.currentContextValue=e.value,N.emit("update",e.value)),e.children!==this.props.children||e.value!==this.props.value}},{key:"render",value:function(){return this.props.children}}]),r}(),ie=(C(ce,"eventBus",N),C(ce,"currentContextValue",void 0),function(){P(r,a.PureComponent);var n=z(r);function r(e){var t;return E(this,r),C(x(t=n.call(this,e)),"state",{context:ce.currentContextValue}),C(x(t),"updateListener",c(function(e){t.setState({context:e})})),N.on("update",t.updateListener),t}return O(r,[{key:"componentWillUnmount",value:function(){N.off("update",this.updateListener)}},{key:"render",value:function(){var e=this.props.children,t=this.state.context;return l(e,void 0,t)}}]),r}()),ae=["children"],ue="qj9A",le=function(){P(c,a.Component);var o=z(c);function c(){var e;E(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C(x(e=o.call.apply(o,[this].concat(n))),"promiseCache",{}),e}return O(c,[{key:"render",value:function(){var e=this.props,t=e.freeze,e=e.children,n=this.promiseCache;if(t&&!n.promise)throw n.promise=new Promise(function(e){n.resolve=e}),n.promise;if(t)throw n.promise;return n.promise&&(n.resolve(),n.promise=void 0),k.createElement(a.Fragment,null,e)}}]),c}();function se(){try{for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(e){var e=F(e),t=e[0];e.slice(1).forEach(function(e){var o;s(u(t,e))&&!u(t,[e,"_overridden"])&&(o=t[e].bind(t),t[e]=function(e){d(e)||ye(e);for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return o.apply(void 0,[e].concat(n))},t[e]._overridden=!0)})})}catch(e){console.warn("activation override failed:",e)}}function fe(e){return e=e.children,l(e)}var pe=[],de=new Map,he=new f,ve=t(function(n){o(n)&&![Z,ne].includes(n)&&(o(n.Consumer)||(n.Consumer=function(e){var e=e.children,t=l(a.useContext,void 0,n);return k.createElement(a.Fragment,null,l(e,void 0,t))}),pe.push(n),setTimeout(function(){return he.emit("update")}))}),ye=t(function(e){e=u(e,"_context")||u(e,"context");u(e,"$$typeof")===u(Z,"$$typeof")&&ve(e)}),me=(se([k,"createElement"]),function(){P(o,a.PureComponent);var r=z(o);function o(e){E(this,o),C(x(t=r.call(this,e)),"unmount",null);var t,n,e=e.value;return 0===e.length?(t.state={ctxValue:null},L(t)):((e=M(e,1)[0]).ctx,n=e.value,e=e.onUpdate,t.state={ctxValue:n},t.unmount=e(function(e){t.setState({ctxValue:e})}),t)}return O(o,[{key:"componentWillUnmount",value:function(){l(this.unmount)}},{key:"render",value:function(){var e,t,n=this.props,r=n.value,n=n.children,r=r.filter(Boolean);return 0===r.length?n:(e=this.state.ctxValue,t=(r=F(r))[0].ctx,r=r.slice(1),t=t.Provider,t=h(e)?n:k.createElement(t,{value:e,_nk:"".concat("lqEk","11")},n),0<r.length?k.createElement(o,{value:r,_nk:"".concat("lqEk","21")},t):t)}}]),o}()),be=function(){P(c,a.Component);var o=z(c);function c(e){E(this,c),C(x(t=o.call(this,e)),"updateListener",null),C(x(t),"ctxInfo",null);var t,n=e.value,r=e.ctx,e=e.id;return h(n)?L(t):(t.updateListener=u(de.get(r),e,new Map),l(t.updateListener,"forEach",function(e){return e(n)}),t.ctxInfo={ctx:r,value:n,onUpdate:function(e){return t.updateListener.set(e,e),function(){return t.updateListener.delete(e)}}},t)}return O(c,[{key:"componentWillUnmount",value:function(){var e=this.props,t=e.value,n=e.ctx,e=e.id;h(t)||de.set(n,S(S({},u(de.get(n),void 0,{})),{},C({},e,this.updateListener)))}},{key:"shouldComponentUpdate",value:function(e){var t=e.value;return this.props.value!==t&&l(this.updateListener,"forEach",function(e){return e(t)}),!0}},{key:"render",value:function(){var t=this,e=this.props,n=e.value,r=e.renderWrapper,o=e.renderContent;e.id;return r(function(e){return o(h(n)?e:[].concat(A(e),[t.ctxInfo]))})}}]),c}(),ge={},we=function(){P(r,a.PureComponent);var n=z(r);function r(e){E(this,r),C(x(t=n.call(this,e)),"renderWrapper",function(e){var o=t.props.id;return ge[o].reduce(function(n,r){var e=r.Consumer;return function(t){return k.createElement(e,{_nk:"".concat("SsUr","11")},function(e){return k.createElement(be,{value:e,ctx:r,renderWrapper:n,renderContent:t,id:o,_nk:"".concat("SsUr","21")})})}},function(e){return e([])})(e)});var t,e=e.id;return ge[e]||(ge[e]=A(pe).filter(function(e){return o(e.Consumer)})),t}return O(r,[{key:"render",value:function(){var e=this.props.children;return this.renderWrapper(e)}}]),r}(),ke="46lG",t=s(a.lazy)&&!h(a.Suspense),Se=t?a.lazy(function(){return new Promise(function(){return null})}):function(){return null},Ee=function(){P(t,a.Component);var e=z(t);function t(){return E(this,t),e.apply(this,arguments)}return O(t,[{key:"componentDidMount",value:function(){l(this.props,"onStart")}},{key:"componentWillUnmount",value:function(){l(this.props,"onEnd")}},{key:"render",value:function(){return null}}]),t}();var Oe=t?function(){P(c,a.Component);var o=z(c);function c(){var e;E(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C(x(e=o.call.apply(o,[this].concat(n))),"state",{suspense:!1}),C(x(e),"onSuspenseStart",function(){e.setState({suspense:!0})}),C(x(e),"onSuspenseEnd",function(){e.setState({suspense:!1})}),C(x(e),"sus$$",{onSuspenseStart:e.onSuspenseStart,onSuspenseEnd:e.onSuspenseEnd}),e}return O(c,[{key:"render",value:function(){var e=this.props.children;return k.createElement(a.Fragment,null,l(e,void 0,this.sus$$),this.state.suspense&&k.createElement(Se,{_nk:"".concat(ke,"31")}))}}]),c}():fe,Ce=t?function(e){var t=e.children,e=e.sus$$;return k.createElement(a.Suspense,{fallback:k.createElement(Ee,{onStart:e.onSuspenseStart,onEnd:e.onSuspenseEnd,_nk:"".concat(ke,"21")}),_nk:"".concat(ke,"11")},t)}:fe,_e=function(){P(t,a.Component);var e=z(t);function t(){return E(this,t),e.apply(this,arguments)}return O(t,[{key:"componentDidCatch",value:function(e){var t=this.props.error$$;l(t,void 0,e,function(){l(t,void 0,null)})}},{key:"render",value:function(){return this.props.children}}]),t}(),Pe=(C(_e,"getDerivedStateFromError",function(){return null}),function(){P(c,a.Component);var o=z(c);function c(){var n;E(this,c);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return C(x(n=o.call.apply(o,[this].concat(t))),"state",{error:null}),C(x(n),"throwError",function(e,t){return n.setState({error:e},t)}),n}return O(c,[{key:"render",value:function(){if(this.state.error)throw this.state.error;return l(this.props.children,void 0,this.throwError)}}]),c}()),I="lajT";function je(e){var t=e.id,n=e.children,e=e.bridgeProps,r=e.sus$$,o=e.ctx$$,e=e.error$$;return k.createElement(_e,{error$$:e,_nk:"".concat(I,"11")},k.createElement(Ce,{sus$$:r,_nk:"".concat(I,"21")},k.createElement(me,{id:t,value:o,_nk:"".concat(I,"31")},n)))}function xe(e){var r=e.id,o=e.children;return k.createElement(Pe,{_nk:"".concat(I,"41")},function(n){return k.createElement(Oe,{_nk:"".concat(I,"51")},function(t){return k.createElement(we,{id:r,_nk:"".concat(I,"61")},function(e){return l(o,void 0,{bridgeProps:{sus$$:t,ctx$$:e,error$$:n}})})})})}function ze(i){var n=function(){P(c,a.Component);var o=z(c);function c(){var e;E(this,c);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return C(x(e=o.call.apply(o,[this].concat(n))),"drop",null),e}return O(c,[{key:"componentWillUnmount",value:function(){l(this.drop)}},{key:"render",value:function(){var n=this,e=this.props,r=e.forwardedRef,t=j(e,Ne);return k.createElement(oe,{_nk:"".concat(Ie,"11")},function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).attach;return k.createElement(i,_({ref:function(t){[B,$].every(function(e){return!s(u(t,e))})||(n.drop=l(e,void 0,t),h(r))||(v(r)&&"current"in r?r.current=t:l(r,void 0,t))}},t,{_nk:"".concat(Ie,"21")}))})}}]),c}();return s(i.prototype.componentDidMount)&&(i.prototype._componentDidMount=i.prototype.componentDidMount,i.prototype.componentDidMount=function(){var e=this;p(function(){return i.prototype._componentDidMount.call(e)})}),s(a.forwardRef)?y(a.forwardRef(function(e,t){return k.createElement(n,_({},e,{forwardedRef:t,_nk:"".concat(Ie,"31")}))}),i):y(n,i)}function Ae(e,t){var n,r;[a.useRef,a.useContext,a.useEffect].some(function(e){return!s(e)})||(r=a.useContext(ne))&&(n=a.useRef({}).current,r=r.attach,n[e]=t,n.drop=r(n),a.useEffect(function(){return function(){return l(n.drop)}},[]))}var Ne=["forwardedRef"],Ie="XKTv",B="componentDidActivate",$="componentWillUnactivate",t=Ae.bind(null,B),Be=Ae.bind(null,$),$e=["id","autoFreeze"],Te="bNyU",Ue=a.Suspense?function(e){var t=e.freeze,n=e.children,e=e.placeholder;return k.createElement(a.Suspense,{fallback:void 0===e?null:e,_nk:"".concat("Leb+","11")},k.createElement(le,{freeze:t,_nk:"".concat("Leb+","21")},n))}:function(e){return e.children},qe=function(){P(c,a.PureComponent);var o=z(c);function c(e){var a;E(this,c);for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return C(x(a=o.call.apply(o,[this,e].concat(n))),"eventBus",new f),C(x(a),"listeners",new Map),C(x(a),"wrapper",null),C(x(a),"cache",void 0),C(x(a),"unmounted",!1),C(x(a),"safeSetState",function(e,t){a.unmounted||a.setState(e,t)}),C(x(a),"freezeTimeout",null),C(x(a),"attach",function(n){var e,t=a.listeners;return n?(n.isKeepAlive&&p(function(){var e=a.props,t=e.id,e=e.store.get(t);e.aliveNodesId=new Set([].concat(A(e.aliveNodesId),[n.id]))}),t.set(n,(C(e={},B,function(){return l(n,B)}),C(e,$,function(){return l(n,$)}),e)),function(){t.delete(n)}):function(){return null}}),C(x(a),"contextValue",{id:a.props.id,attach:a.attach}),C(x(a),"drop",function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).delay,i=void 0===e?1200:e;return new Promise(function(e){function t(){clearTimeout(n),a.eventBus.off($,t),a.cache.willDrop=!0,o.nodes.delete(c),o.helpers=S({},o.helpers),o.smartForceUpdate(function(){return e(!0)})}var n,r=a.props,o=r.scope,c=r.id;u(a.cache,"cached")||u(a.cache,"willDrop")?t():(a.eventBus.on($,t),n=setTimeout(function(){a.eventBus.off($,t),e(!1)},i))})}),C(x(a),"refresh",function(){return new Promise(function(e){u(a.cache,"cached")&&e(!1),a.safeSetState({key:Math.random()},function(){return e(!0)})})}),a.state={children:e.children,bridgeProps:e.bridgeProps,key:Math.random(),freeze:!1},a}return O(c,[{key:"componentDidMount",value:function(){var t,e=this,n=this.props,r=n.store,n=n.id,o=this.listeners,c=this.wrapper;if(!r.has(n)){try{t=A(c.children)}catch(e){t=[c.children]}this.cache=(C(o={listeners:o,aliveNodesId:[],inited:!1,cached:!1,wrapper:c,nodes:t},B,function(){return e[B]()}),C(o,$,function(){return e[$]()}),o),r.set(n,this.cache)}}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.store,n=e.keepers,e=e.id;try{var r=t.get(e);r.nodes.forEach(function(e){r.wrapper.appendChild(e)})}catch(e){}t.delete(e),n.delete(e),this.unmounted=!0}},{key:B,value:function(){clearTimeout(this.freezeTimeout),this.safeSetState({freeze:!1}),this.eventBus.emit(B),this.listeners.forEach(function(e){return l(e,[B])})}},{key:$,value:function(){var e=this;this.eventBus.emit($),A(this.listeners).reverse().forEach(function(e){e=M(e,2)[1];return l(e,[$])}),clearTimeout(this.freezeTimeout),this.freezeTimeout=setTimeout(function(){r.flushSync(function(){e.safeSetState({freeze:!0})})},1e3)}},{key:"render",value:function(){var t=this,e=this.props,n=e.id,r=e.autoFreeze,r=void 0===r||r,e=(j(e,$e),this.state),o=e.children,c=e.bridgeProps,i=e.key,e=e.freeze;return k.createElement(Ue,{freeze:r&&e,_nk:"".concat(Te,"11")},k.createElement("div",{ref:function(e){t.wrapper=e},_nk:"".concat(Te,"21")},k.createElement("div",{key:"keeper-container",className:"ka-content"},k.createElement(je,{id:n,bridgeProps:c,_nk:"".concat(Te,"31")},k.createElement(re,{value:this.contextValue,_nk:"".concat(Te,"41")},k.Children.map(o,function(e,t){return k.cloneElement(e,{key:"".concat(e.key||"",":").concat(i,":").concat(t)})}))))))}}]),c}(),Re=["children"],De="UVSV",Le="drop",Me="refresh",Fe=function(){P(o,a.Component);var r=z(o);function o(){var a;E(this,o);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return C(x(a=r.call.apply(r,[this].concat(t))),"store",new Map),C(x(a),"nodes",new Map),C(x(a),"keepers",new Map),C(x(a),"debouncedForceUpdate",c(function(e){return a.forceUpdate(e)})),C(x(a),"updateCallbackList",[]),C(x(a),"smartForceUpdate",function(e){a.updateCallbackList.push(e),a.debouncedForceUpdate(function(){a.updateCallbackList.forEach(function(e){return l(e)}),a.updateCallbackList=[]})}),C(x(a),"update",function(c,i){return new Promise(function(e){var t=a.keepers.get(c),n=!t,r=Date.now(),o=a.nodes.get(c)||null;a.nodes.set(c,S(S({id:c,createTime:r,updateTime:r},o),i)),n?(a.helpers=S({},a.helpers),a.forceUpdate(e)):(r=i.children,o=i.bridgeProps,t.setState({children:r,bridgeProps:o},e))})}),C(x(a),"keep",function(t,n){return new Promise(function(e){a.update(t,S({id:t},n)).then(function(){e(a.store.get(t))})})}),C(x(a),"getCachingNodesByName",function(t){return a.getCachingNodes().filter(function(e){return t instanceof RegExp?t.test(e.name):e.name===t})}),C(x(a),"getScopeIds",function(e){return i(e.map(function e(t){var n=u(a.getCache(t),"aliveNodesId",[]);return 0<n.size?[t,A(n).map(e)]:[t].concat(A(n))}))}),C(x(a),"dropById",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[[e],Le].concat(n))}),C(x(a),"dropScopeByIds",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getScopeIds(e),Le].concat(n))}),C(x(a),"drop",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id}),Le].concat(n))}),C(x(a),"dropScope",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.dropScopeByIds.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id})].concat(n))}),C(x(a),"refreshById",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[[e],Me].concat(n))}),C(x(a),"refreshScopeByIds",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getScopeIds(e),Me].concat(n))}),C(x(a),"refresh",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.handleNodes.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id}),Me].concat(n))}),C(x(a),"refreshScope",function(e){for(var t=arguments.length,n=new Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return a.refreshScopeByIds.apply(a,[a.getCachingNodesByName(e).map(function(e){return e.id})].concat(n))}),C(x(a),"handleNodes",function(e){for(var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Le,t=arguments.length,o=new Array(2<t?t-2:0),n=2;n<t;n++)o[n-2]=arguments[n];return new Promise(function(t){var n=[];e.forEach(function(e){a.store.get(e)&&(e=a.keepers.get(e),n.push(e))}),0===n.length?t(!1):Promise.all(n.map(function(e){return l.apply(void 0,[e,r].concat(o))})).then(function(e){return t(e.every(Boolean))})})}),C(x(a),"clear",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return a.handleNodes.apply(a,[a.getCachingNodes().map(function(e){return e.id}),Le].concat(t))}),C(x(a),"getCache",function(e){return a.store.get(e)}),C(x(a),"getNode",function(e){return a.nodes.get(e)}),C(x(a),"getCachingNodes",function(){return A(a.nodes.values())}),C(x(a),"helpers",{keep:a.keep,update:a.update,drop:a.drop,dropScope:a.dropScope,dropById:a.dropById,dropScopeByIds:a.dropScopeByIds,refresh:a.refresh,refreshScope:a.refreshScope,refreshById:a.refreshById,refreshScopeByIds:a.refreshScopeByIds,getScopeIds:a.getScopeIds,clear:a.clear,getCache:a.getCache,getNode:a.getNode,getCachingNodes:a.getCachingNodes}),a}return O(o,[{key:"render",value:function(){var r=this,e=this.props.children,e=void 0===e?null:e;return k.createElement(J,{value:this.helpers,_nk:"".concat(De,"11")},e,k.createElement("div",{style:{display:"none"},_nk:"".concat(De,"21")},A(this.nodes.values()).map(function(e){var t=e.children,n=j(e,Re);return k.createElement(qe,_({key:n.id},n,{scope:r,store:r.store,keepers:r.keepers,ref:function(e){r.keepers.set(n.id,e)},_nk:"iAr".concat(De,"31")}),t)})))}}]),o}(),We=["id"],Ve=["id"],Ke=["forwardedRef"],He=["forwardedRef"],T="X7Aa";function Xe(e){return{drop:e.drop,dropScope:e.dropScope,refresh:e.refresh,refreshScope:e.refreshScope,clear:e.clear,getCachingNodes:e.getCachingNodes}}function Ge(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!!o(e)&&(e.scrollWidth>e.clientWidth||e.scrollHeight>e.clientHeight)}function Ye(e){return s(u(g,"document.querySelectorAll"))?[].concat(A(m(l(e,"querySelectorAll","*"),[])),[e]).filter(Ge):[]}var Je=["_helpers","id","children"],Qe=["_helpers","id","name"],Ze=u(g,"document.body"),et=u(g,"document.scrollingElement",u(g,"document.documentElement",{})),tt=function(){P(n,a.Component);var t=z(n);function n(e){var c;return E(this,n),C(x(c=t.call(this,e)),"id",null),C(x(c),"isKeepAlive",!0),C(x(c),"cached",!1),C(x(c),"inject",function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=c.props,n=t.id,r=t.saveScrollPosition,t=t._helpers.getCache(n);try{t.nodes.forEach(function(e){c.placeholder.appendChild(e)}),e&&r&&l(t.revertScrollPos)}catch(e){}}),C(x(c),"eject",function(){var e,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n=c.props,r=n.id,o=n._helpers.getCache(r),n=i(i([c.props.saveScrollPosition]).map(function(e){return!0===e?o.nodes:"screen"===e?[et,Ze]:A(m(l(g,"document.querySelectorAll",e),[]))})).filter(Boolean);try{t&&0<n.length&&(o.revertScrollPos=(e=A(new Set(A(i(n.map(Ye))))).map(function(e){return[e,{x:e.scrollLeft,y:e.scrollTop}]}),function(){e.forEach(function(e){var e=M(e,2),t=e[0],e=e[1],n=e.x,e=e.y;t.scrollLeft=n,t.scrollTop=e})})),o.nodes.forEach(function(e){t?c.placeholder.removeChild(e):o.wrapper.appendChild(e)})}catch(e){}}),C(x(c),"init",function(){var e=c.props,t=e._helpers,n=e.id,r=e.children,e=j(e,Je);t.keep(n,S({children:r,getInstance:function(){return x(c)}},e)).then(function(e){e&&(c.inject(),e.inited?l(x(c),B):e.inited=!0,c.cached=!1)})}),C(x(c),"update",function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e._helpers,n=e.id,r=e.name,e=j(e,Qe);t&&!c.cached&&t.update(n,S({name:r,getInstance:function(){return x(c)}},e))}),c.id=e.id,c.init(),[B,$].forEach(function(r){c[r]=function(){var e=c.props,t=e.id,e=e._helpers,n=e.getCache(t),e=e.getNode(t),t=(e&&r===B&&(e.updateTime=Date.now()),r===$);!n||n.willDrop?c.cached&&!t&&c.init():(l(n,r),n.cached=t,c.cached=t)}}),c}return O(n,[{key:"shouldComponentUpdate",value:function(e){return this.update(e),!1}},{key:"componentWillUnmount",value:function(){var e=this.props,t=e.id,n=e._helpers,e=e.when,e=void 0===e||e,r=n.getCache(t);e=l(e);var e=M(b(e)?e:[e],2),o=e[0],e=e[1];r&&(this.eject(),delete r.getInstance,o||(e?([r].concat(A(n.getScopeIds([t]).map(function(e){return n.getCache(e)}))).filter(Boolean).forEach(function(e){e.willDrop=!0}),p(function(){return n.dropScopeByIds([t])})):(r.willDrop=!0,p(function(){return n.dropById(t)}))),l(this,$))}},{key:"render",value:function(){var t=this;return k.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper",ref:function(e){t.placeholder=e}})}}]),n}();C(tt,"defaultProps",{saveScrollPosition:!0});var nt,tt=s(u(g,"document.getElementById"))?(nt=ze(tt),s(a.useContext)?function(e){var t=e.id,e=j(e,We);return rt({idPrefix:t,helpers:Y(),props:e})}:function(e){var t=e.id,n=j(e,Ve);return k.createElement(Q,{_nk:"".concat(T,"41")},function(e){return rt({idPrefix:t,helpers:e,props:n})})}):function(e){return e=e.children,k.createElement("div",{key:"keep-alive-placeholder",className:"ka-wrapper"},k.createElement("div",{key:"keeper-container",className:"ka-content"},e))};function rt(e){var t=e.idPrefix,n=e.helpers,r=e.props;return(e=h(n))&&console.error("You should not use <KeepAlive /> outside a <AliveScope>"),e?u(r,"children",null):k.createElement(w,{prefix:t,key:r._nk,manualKey:r.cacheKey,_nk:"".concat(T,"11")},function(e){var t=r.cacheKey||e;return k.createElement(xe,{key:t,id:t,_nk:"".concat(T,"21")},function(e){return k.createElement(nt,_({key:t},r,e,{id:t,_helpers:n,_nk:"".concat(T,"31")}))})})}e.AliveScope=Fe,e.KeepAlive=tt,e.NodeKey=w,e.autoFixContext=se,e.createContext=function(e,t){e=n(e,t);return ve(e),e},e.default=tt,e.fixContext=ve,e.useActivate=t,e.useAliveController=function(){var e;return s(a.useContext)&&(e=Y())?Xe(e):{}},e.useUnactivate=Be,e.withActivation=ze,e.withAliveScope=function(r){function o(e){var t=e.helpers,n=e.props,e=e.forwardedRef;return k.createElement(r,_({},n,t,{ref:e,_nk:"".concat(T,"51")}))}var n=s(a.useContext)?function(e){var t=e.forwardedRef,e=j(e,Ke);return o({helpers:Xe(Y()||{}),props:e,forwardedRef:t})}:function(e){var t=e.forwardedRef,n=j(e,He);return k.createElement(Q,{_nk:"".concat(T,"42")},function(){return o({helpers:Xe(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}),props:n,forwardedRef:t})})};return s(a.forwardRef)?y(a.forwardRef(function(e,t){return k.createElement(n,_({},e,{forwardedRef:t,_nk:"".concat(T,"61")}))}),r):y(n,r)},Object.defineProperty(e,"__esModule",{value:!0})});
