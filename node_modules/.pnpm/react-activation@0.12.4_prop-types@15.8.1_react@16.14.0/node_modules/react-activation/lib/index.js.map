{"version":3,"file":"index.js","sources":["../src/helpers/is/index.js","../src/core/context/reactContext.js","../src/core/context/FakeScopeContext.js","../src/core/context/index.js","../src/core/Freeze.js","../src/core/Bridge/Context/fixContext.js","../src/core/Bridge/Context/ProviderBridge.js","../src/core/Bridge/Context/ConsumerWrapper.js","../src/core/Bridge/Context/ConsumerBridge.js","../src/core/Bridge/Suspense.js","../src/core/Bridge/ErrorBoundary.js","../src/core/Bridge/index.js","../src/core/lifecycles.js","../src/core/Keeper.js","../src/core/AliveScope.js","../src/core/withAliveScope.js","../src/helpers/saveScrollPosition.js","../src/core/KeepAlive.js"],"sourcesContent":["// 值类型判断 +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\nexport const isRegExp = (val) => val instanceof RegExp\n// 值类型判断 -------------------------------------------------------------\n","import createContext from 'create-react-context'\n\n// 整个 KeepAlive 功能的上下文，将 KeepAlive 的组件藏于其 Provider 中，保证其不会被卸载\nexport const aliveScopeContext = createContext()\nexport const {\n  Provider: AliveScopeProvider,\n  Consumer: AliveScopeConsumer,\n} = aliveScopeContext\n\n// KeepAlive 组件的上下文，实现缓存生命周期功能\nexport const aliveNodeContext = createContext()\nexport const {\n  Provider: AliveNodeProvider,\n  Consumer: AliveNodeConsumer,\n} = aliveNodeContext\n","import { Component, PureComponent } from 'react'\nimport { EventBus, run, debounce } from 'szfe-tools'\n\nexport const eventBus = new EventBus()\n\nexport class FakeScopeProvider extends Component {\n  static eventBus = eventBus\n  static currentContextValue = undefined\n\n  constructor(props) {\n    super(props)\n    FakeScopeProvider.currentContextValue = props.value\n  }\n\n  shouldComponentUpdate(nextProps) {\n    if (nextProps.value !== this.props.value) {\n      FakeScopeProvider.currentContextValue = nextProps.value\n      eventBus.emit('update', nextProps.value)\n    }\n\n    return (\n      nextProps.children !== this.props.children ||\n      nextProps.value !== this.props.value\n    )\n  }\n\n  render() {\n    const { children } = this.props\n    return children\n  }\n}\n\nexport class FakeScopeConsumer extends PureComponent {\n  state = {\n    context: FakeScopeProvider.currentContextValue,\n  }\n\n  constructor(props) {\n    super(props)\n    eventBus.on('update', this.updateListener)\n  }\n\n  updateListener = debounce((nextContextValue) => {\n    this.setState({\n      context: nextContextValue,\n    })\n  })\n\n  componentWillUnmount() {\n    eventBus.off('update', this.updateListener)\n  }\n\n  render() {\n    const { children } = this.props\n    const { context } = this.state\n    return run(children, undefined, context)\n  }\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useState, useContext, useEffect } from 'react'\nimport { run, debounce, isFunction } from 'szfe-tools'\n\nimport {\n  aliveScopeContext,\n  AliveScopeProvider as AliveScopeReactProvider,\n  AliveScopeConsumer as AliveScopeReactConsumer,\n  aliveNodeContext,\n  AliveNodeProvider,\n  AliveNodeConsumer,\n} from './reactContext'\nimport {\n  eventBus as fakeContextEventBus,\n  FakeScopeProvider,\n  FakeScopeConsumer,\n} from './FakeScopeContext'\n\nexport const useScopeContext = () => {\n  if (!isFunction(useContext)) {\n    return {}\n  }\n\n  const scopeReactContext = useContext(aliveScopeContext)\n\n  if (scopeReactContext) {\n    return scopeReactContext\n  }\n\n  const [context, setContext] = useState(FakeScopeProvider.currentContextValue)\n\n  useEffect(() => {\n    const updateListener = debounce(setContext)\n    fakeContextEventBus.on('update', updateListener)\n    return () => fakeContextEventBus.off('update', updateListener)\n  }, [])\n\n  return context\n}\n\nexport const AliveScopeProvider = ({ children, ...props }) => (\n  <AliveScopeReactProvider {...props}>\n    <FakeScopeProvider {...props}>{children}</FakeScopeProvider>\n  </AliveScopeReactProvider>\n)\nexport const AliveScopeConsumer = ({ children }) => (\n  <AliveScopeReactConsumer>\n    {(reactContext) =>\n      !!reactContext ? (\n        run(children, undefined, reactContext)\n      ) : (\n        <FakeScopeConsumer>{children}</FakeScopeConsumer>\n      )\n    }\n  </AliveScopeReactConsumer>\n)\nexport {\n  aliveScopeContext,\n  aliveNodeContext,\n  AliveNodeProvider,\n  AliveNodeConsumer,\n}\n","// Fork from react-freeze\r\n// https://github.com/software-mansion/react-freeze/blob/main/src/index.tsx\r\nimport React, { Component, Suspense, Fragment } from 'react'\r\n\r\n// function Suspender({ freeze, children }) {\r\n//   const promiseCache = useRef({}).current\r\n//   if (freeze && !promiseCache.promise) {\r\n//     promiseCache.promise = new Promise((resolve) => {\r\n//       promiseCache.resolve = resolve\r\n//     })\r\n//     throw promiseCache.promise\r\n//   } else if (freeze) {\r\n//     throw promiseCache.promise\r\n//   } else if (promiseCache.promise) {\r\n//     promiseCache.resolve()\r\n//     promiseCache.promise = undefined\r\n//   }\r\n\r\n//   return <Fragment>{children}</Fragment>\r\n// }\r\n\r\nclass Suspender extends Component {\r\n  promiseCache = {}\r\n  render() {\r\n    const { freeze, children } = this.props\r\n    const { promiseCache } = this\r\n\r\n    if (freeze && !promiseCache.promise) {\r\n      promiseCache.promise = new Promise((resolve) => {\r\n        promiseCache.resolve = resolve\r\n      })\r\n      throw promiseCache.promise\r\n    } else if (freeze) {\r\n      throw promiseCache.promise\r\n    } else if (promiseCache.promise) {\r\n      promiseCache.resolve()\r\n      promiseCache.promise = undefined\r\n    }\r\n\r\n    return <Fragment>{children}</Fragment>\r\n  }\r\n}\r\n\r\nexport default function Freeze({ freeze, children, placeholder = null }) {\r\n  return (\r\n    <Suspense fallback={placeholder}>\r\n      <Suspender freeze={freeze}>{children}</Suspender>\r\n    </Suspense>\r\n  )\r\n}","import React, { useContext, Fragment } from 'react'\nimport createReactContext from 'create-react-context'\nimport { run, get, isString, isFunction, memoize, EventBus, isExist } from 'szfe-tools'\n\nimport { aliveScopeContext, aliveNodeContext } from '../../context'\n\nexport const fixedContext = []\nexport const updateListenerCache = new Map()\nexport const eventBus = new EventBus()\n\nexport const fixContext = memoize((ctx) => {\n  if (!isExist(ctx)) {\n    return\n  }\n\n  // 排除 KeepAlive 功能的上下文\n  if ([aliveScopeContext, aliveNodeContext].includes(ctx)) {\n    return\n  }\n\n  // #259: 结合 use-context-selector 时，修复被删除的 Consumer\n  if (!isExist(ctx.Consumer)) {\n    function Consumer({ children }) {\n      const ctxValue = run(useContext, undefined, ctx)\n    \n      return <Fragment>{run(children, undefined, ctxValue)}</Fragment>\n    }\n    \n    // 重新声明 Consumer\n    ctx.Consumer = Consumer\n  }\n\n  fixedContext.push(ctx)\n  setTimeout(() => eventBus.emit('update'))\n})\n\nexport const createContext = (defaultValue, calculateChangedBits) => {\n  const ctx = createReactContext(defaultValue, calculateChangedBits)\n\n  fixContext(ctx)\n  return ctx\n}\n\nconst tryFixCtx = memoize((type) => {\n  // 尝试读取 Provider 或 Consumer 中的 context 静态属性\n  const ctx = get(type, '_context') || get(type, 'context') // 16.3.0 版本为 context，之后为 _context\n\n  // 判断是否为 ReactContext 类型\n  if (get(ctx, '$$typeof') === get(aliveScopeContext, '$$typeof')) {\n    fixContext(ctx)\n  }\n})\n\nconst override = (configs) => {\n  configs.forEach(([host, ...methods]) => {\n    methods.forEach((method) => {\n      if (\n        !isFunction(get(host, method)) ||\n        get(host, [method, '_overridden'])\n      ) {\n        return\n      }\n      const originMethod = host[method].bind(host)\n      host[method] = (type, ...args) => {\n        if (!isString(type)) {\n          tryFixCtx(type)\n        }\n        return originMethod(type, ...args)\n      }\n      host[method]._overridden = true\n    })\n  })\n}\n\n/**\n * 通过覆写 React.createElement 方法来探测 Provider 或 Consumer 的创建，并攫取其中 context 主动进行修复\n * TODO：同时兼容 React 17+，目前仅默认兼容 React.createElement 方法\n * React 17+ 为 require('react/jsx-runtime') 或 require('react/jsx-dev-runtime') 的 jsx、jsxs、jsxDEV 方法\n * 但由于无法动态 require，暂未想到方式同时兼容\n * 若需兼容 17+，目前手法为\n *\n * autoFixContext(\n *   [require('react/jsx-runtime'), 'jsx', 'jsxs', 'jsxDEV'],\n *   [require('react/jsx-dev-runtime'), 'jsx', 'jsxs', 'jsxDEV']\n * )\n *\n * Note: 需注意 16.2.x 及以下版本不支持此方法\n */\nexport const autoFixContext = (...configs) => {\n  try {\n    override(configs)\n  } catch (err) {\n    console.warn('activation override failed:', err)\n  }\n}\n\nautoFixContext([React, 'createElement'])\n","import React, { PureComponent } from 'react'\nimport { run, isUndefined } from 'szfe-tools'\n\nexport default class ProviderBridge extends PureComponent {\n  unmount = null\n  constructor(props) {\n    super(props)\n\n    const { value: ctxValues } = props\n\n    if (ctxValues.length === 0) {\n      this.state = {\n        ctxValue: null,\n      }\n\n      return\n    }\n\n    const [{ ctx, value, onUpdate }] = ctxValues\n\n    this.state = {\n      ctxValue: value,\n    }\n\n    this.unmount = onUpdate((value) => {\n      this.setState({\n        ctxValue: value,\n      })\n    })\n  }\n\n  componentWillUnmount() {\n    run(this.unmount)\n  }\n\n  // componentDidCatch(error) {\n  //   console.error('ProviderBridge Error', error)\n  // }\n\n  render() {\n    const { value: propCtxValues, children } = this.props\n    const ctxValues = propCtxValues.filter(Boolean)\n\n    if (ctxValues.length === 0) {\n      return children\n    }\n\n    const { ctxValue } = this.state\n    const [{ ctx }, ...restValues] = ctxValues\n    const { Provider } = ctx\n\n    const nextChildren = !isUndefined(ctxValue) ? (\n      <Provider value={ctxValue}>{children}</Provider>\n    ) : (\n      children\n    )\n\n    // 递归 ProviderBridge 修复多个上下文\n    // 此处未考虑待修复上下文顺序问题，按先来后到顺序处理，但理论上不应存在顺序问题\n    return restValues.length > 0 ? (\n      <ProviderBridge value={restValues}>{nextChildren}</ProviderBridge>\n    ) : (\n      nextChildren\n    )\n  }\n}\n","import { Component } from 'react'\nimport { run, get, isUndefined } from 'szfe-tools'\n\nimport { updateListenerCache } from './fixContext'\n\n// 在 KeepAlive 位置使用待修复上下文的 Consumer 探测可能存在的上下文关系\n// 若成功捕获上下文则保存其内容，用以后续 Keeper 中上下文的重建\nexport default class ConsumerWrapper extends Component {\n  updateListener = null\n  ctxInfo = null\n  constructor(props) {\n    super(props)\n\n    const { value, ctx, id } = props\n    if (isUndefined(value)) {\n      return\n    }\n\n    // 因 Consumer 探测器存在于 KeepAlive 外层故会随着 KeepAlive 卸载\n    // componentWillUnmount 中保留了已生成的更新监听器\n    // 此处重新挂载后恢复与对应 Keeper 中 ProviderBridge 的联系\n    this.updateListener = get(updateListenerCache.get(ctx), id, new Map())\n    run(this.updateListener, 'forEach', (fn) => fn(value))\n    this.ctxInfo = {\n      ctx,\n      value,\n      // 注册上下文更新的监听，保证上下文更新时 Keeper 中 ProviderBridge 内容的同步\n      onUpdate: (updator) => {\n        this.updateListener.set(updator, updator)\n\n        // 返回更新监听器的注销方法\n        return () => this.updateListener.delete(updator)\n      },\n    }\n  }\n\n  componentWillUnmount() {\n    const { value, ctx, id } = this.props\n    if (isUndefined(value)) {\n      return\n    }\n\n    // 因 Consumer 探测器存在于 KeepAlive 外层故会随着 KeepAlive 卸载\n    // 此处保留其中已生成的更新监听器，用以在重新挂载后保持与对应 Keeper 中 ProviderBridge 的联系\n    updateListenerCache.set(ctx, {\n      ...get(updateListenerCache.get(ctx), undefined, {}),\n      [id]: this.updateListener,\n    })\n  }\n\n  // 利用 shouldComponentUpdate 尽早将上下文更新的咨询通知到对应 Keeper 中 ProviderBridge\n  // TODO: 改用 componentWillReceiveProps 更早地进行更新，需注意与 getDerivedStateFromProps 新生命周期的兼容及可能存在的死循环问题\n  shouldComponentUpdate({ value }) {\n    const { value: prevValue } = this.props\n    const shouldUpdate = prevValue !== value\n\n    if (shouldUpdate) {\n      run(this.updateListener, 'forEach', (fn) => fn(value))\n    }\n\n    return true\n  }\n\n  render() {\n    const { value, renderWrapper, renderContent, id } = this.props\n\n    return renderWrapper((ctx$$) =>\n      renderContent(isUndefined(value) ? ctx$$ : [...ctx$$, this.ctxInfo])\n    )\n  }\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport React, {\n  PureComponent,\n  useContext,\n  useRef,\n  useEffect,\n  useState,\n} from 'react'\nimport { run, get, nextTick, isUndefined, isFunction, isExist } from 'szfe-tools'\n\nimport ConsumerWrapper from './ConsumerWrapper'\nimport { fixedContext, eventBus, updateListenerCache } from './fixContext'\n\nconst fixedContextSnapshot = {}\n\n// 对 ConsumerWrapper 的递归结构，会在 devtool 中生成较深的嵌套结构，可用 hooks 消除嵌套结构\nclass RecursiveConsumerBridge extends PureComponent {\n  constructor(props) {\n    super(props)\n    const { id } = props\n\n    if (!fixedContextSnapshot[id]) {\n      fixedContextSnapshot[id] = [...fixedContext].filter(ctx => isExist(ctx.Consumer))\n    }\n  }\n\n  renderWrapper = (renderChildren) => {\n    const { id } = this.props\n\n    const renderWrapper = fixedContextSnapshot[id].reduce(\n      (render, ctx) => {\n        const { Consumer } = ctx\n\n        const renderWrapper = (renderContent) => (\n          <Consumer>\n            {(value) => (\n              <ConsumerWrapper\n                {...{\n                  value,\n                  ctx,\n                  renderWrapper: render,\n                  renderContent,\n                  id,\n                }}\n              />\n            )}\n          </Consumer>\n        )\n\n        return renderWrapper\n      },\n      (renderContent) => renderContent([])\n    )\n\n    return renderWrapper(renderChildren)\n  }\n\n  render() {\n    const { children: renderChildren } = this.props\n\n    return this.renderWrapper(renderChildren)\n  }\n}\n\n// 若支持 Hooks，就不需要递归了，相关实现解释可参考 ConsumerWrapper\n// function HooksConsumerBridge({ children: renderChildren, id }) {\n//   const [, setRenderKey] = useState(Math.random)\n\n//   useEffect(() => {\n//     // 渲染时若 fixedContext 列表更新，则需强制刷新\n//     const updateListener = () => setRenderKey(Math.random)\n//     eventBus.on('update', updateListener)\n//     return () => {\n//       eventBus.off('update', updateListener)\n//     }\n//   }, [])\n\n//   const context$$ = fixedContext\n//     .map((ctx) => {\n//       const value = useContext(ctx)\n//       const prevValueRef = useRef(value)\n//       const { current: updateListener } = useRef(\n//         get(updateListenerCache.get(ctx), id, new Map())\n//       )\n\n//       // 尽可能早地进行更新\n//       if (prevValueRef.current !== value) {\n//         nextTick(() => run(updateListener, 'forEach', (fn) => fn(value)))\n//       }\n//       prevValueRef.current = value\n\n//       useEffect(() => {\n//         return () => {\n//           if (isUndefined(value)) {\n//             return\n//           }\n\n//           updateListenerCache.set(ctx, {\n//             ...get(updateListenerCache.get(ctx), undefined, {}),\n//             [id]: updateListener,\n//           })\n//         }\n//       }, [])\n\n//       return {\n//         ctx,\n//         value,\n//         onUpdate: (fn) => {\n//           updateListener.set(fn, fn)\n\n//           return () => updateListener.delete(fn)\n//         },\n//       }\n//     })\n//     .filter(({ value }) => !isUndefined(value))\n\n//   return renderChildren(context$$)\n// }\n\n// fix #99\n// const ConsumerBridge = [useContext, useRef, useEffect].every(isFunction)\n//   ? HooksConsumerBridge\n//   : RecursiveConsumerBridge\n// fix #99\nexport default RecursiveConsumerBridge\n","import React, { lazy, Suspense, Component, Fragment } from 'react'\nimport { run, isUndefined, isFunction } from 'szfe-tools'\n\n// 兼容性检测\nconst isSupported = isFunction(lazy) && !isUndefined(Suspense)\nconst SusNotSupported = ({ children }) => run(children)\n\nconst Lazy = isSupported ? lazy(() => new Promise(() => null)) : () => null\n\nclass FallbackListener extends Component {\n  componentDidMount() {\n    run(this.props, 'onStart')\n  }\n\n  componentWillUnmount() {\n    run(this.props, 'onEnd')\n  }\n\n  render() {\n    return null\n  }\n}\n\nfunction SuspenseBridge({ children, sus$$ }) {\n  return (\n    // 捕获 Keeper 内部可能存在的 lazy，并触发对应 KeepAlive 位置上的 LazyBridge\n    <Suspense\n      fallback={\n        <FallbackListener\n          onStart={sus$$.onSuspenseStart}\n          onEnd={sus$$.onSuspenseEnd}\n        />\n      }\n    >\n      {children}\n    </Suspense>\n  )\n}\n\nexport const LazyBridge = isSupported\n  ? class LazyBridge extends Component {\n      state = {\n        suspense: false,\n      }\n\n      onSuspenseStart = () => {\n        this.setState({\n          suspense: true,\n        })\n      }\n\n      onSuspenseEnd = () => {\n        this.setState({\n          suspense: false,\n        })\n      }\n\n      sus$$ = {\n        onSuspenseStart: this.onSuspenseStart,\n        onSuspenseEnd: this.onSuspenseEnd,\n      }\n\n      render() {\n        const { children } = this.props\n\n        return (\n          <Fragment>\n            {run(children, undefined, this.sus$$)}\n            {/* 渲染 Lazy 以触发 KeepAlive 所处位置外部可能存在的 Suspense */}\n            {this.state.suspense && <Lazy />}\n          </Fragment>\n        )\n      }\n    }\n  : SusNotSupported\n\nexport default isSupported ? SuspenseBridge : SusNotSupported\n","import { Component } from 'react'\nimport { run } from 'szfe-tools'\n\nexport default class ErrorBoundaryBridge extends Component {\n  // Error Boundary 透传至对应 KeepAlive 实例位置\n  static getDerivedStateFromError = () => null\n  componentDidCatch(error) {\n    const { error$$: throwError } = this.props\n\n    run(throwError, undefined, error, () => {\n      run(throwError, undefined, null)\n    })\n  }\n\n  render() {\n    return this.props.children\n  }\n}\n\nexport class ErrorThrower extends Component {\n  state = {\n    error: null,\n  }\n\n  throwError = (error, cb) => this.setState({ error }, cb)\n  render() {\n    if (this.state.error) {\n      throw this.state.error\n    }\n\n    return run(this.props.children, undefined, this.throwError)\n  }\n}\n","import React from 'react'\nimport { run } from 'szfe-tools'\n\nimport { ProviderBridge, ConsumerBridge } from './Context'\nimport SuspenseBridge, { LazyBridge } from './Suspense'\nimport ErrorBoundaryBridge, { ErrorThrower } from './ErrorBoundary'\n\n// 用于 Keeper 中，实现 Keeper 向外或向内的桥接代理\nexport default function Bridge({ id, children, bridgeProps }) {\n  const { sus$$, ctx$$, error$$ } = bridgeProps\n\n  return (\n    /* 由内向外透传 componentDidCatch 捕获的 error */\n    <ErrorBoundaryBridge error$$={error$$}>\n      {/* 由内向外透传 lazy 行为 */}\n      <SuspenseBridge sus$$={sus$$}>\n        {/* 由外向内透传可能存在的 Consumer 数据 */}\n        <ProviderBridge id={id} value={ctx$$}>\n          {children}\n        </ProviderBridge>\n      </SuspenseBridge>\n    </ErrorBoundaryBridge>\n  )\n}\n\n// 用于 KeepAlive 中，实现 KeepAlive 向外或向内的桥接代理\nexport function Acceptor({ id, children }) {\n  return (\n    /* 由内向外透传 componentDidCatch 捕获的 error */\n    <ErrorThrower>\n      {(error$$) => (\n        /* 由内向外透传 lazy 行为 */\n        <LazyBridge>\n          {(sus$$) => (\n            /* 由外向内透传可能被捕获的 Provider 数据 */\n            <ConsumerBridge id={id}>\n              {(ctx$$) =>\n                run(children, undefined, {\n                  bridgeProps: {\n                    sus$$,\n                    ctx$$,\n                    error$$,\n                  },\n                })\n              }\n            </ConsumerBridge>\n          )}\n        </LazyBridge>\n      )}\n    </ErrorThrower>\n  )\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport React, {\n  Component,\n  forwardRef,\n  useEffect,\n  useRef,\n  useContext,\n} from 'react'\nimport hoistStatics from 'hoist-non-react-statics'\nimport {\n  get,\n  run,\n  nextTick,\n  isObject,\n  isFunction,\n  isUndefined,\n} from 'szfe-tools'\n\nimport { AliveNodeConsumer, aliveNodeContext } from './context'\n\nexport const LIFECYCLE_ACTIVATE = 'componentDidActivate'\nexport const LIFECYCLE_UNACTIVATE = 'componentWillUnactivate'\n\nexport const withActivation = (WrappedComponent) => {\n  class HOC extends Component {\n    drop = null\n\n    componentWillUnmount() {\n      run(this.drop)\n    }\n\n    render() {\n      const { forwardedRef, ...props } = this.props\n\n      return (\n        <AliveNodeConsumer>\n          {({ attach } = {}) => (\n            <WrappedComponent\n              ref={(ref) => {\n                if (\n                  [LIFECYCLE_ACTIVATE, LIFECYCLE_UNACTIVATE].every(\n                    (lifecycleName) => !isFunction(get(ref, lifecycleName))\n                  )\n                ) {\n                  return\n                }\n                this.drop = run(attach, undefined, ref)\n\n                // 以下保持 ref 功能\n                if (isUndefined(forwardedRef)) {\n                  return\n                }\n\n                if (isObject(forwardedRef) && 'current' in forwardedRef) {\n                  forwardedRef.current = ref\n                  return\n                }\n\n                run(forwardedRef, undefined, ref)\n              }}\n              {...props}\n            />\n          )}\n        </AliveNodeConsumer>\n      )\n    }\n  }\n\n  // 由于 KeepAlive 内组件渲染与实际内容落后一个节拍\n  // 将导致真实节点的 componentDidMount 无法及时获取到 KeepAlive 中内容的 ref 值\n  // 此处对使用了 withActivation HOC 的组件 componentDidMount 做 nextTick 延时处理\n  // 修复上述问题\n\n  if (isFunction(WrappedComponent.prototype.componentDidMount)) {\n    WrappedComponent.prototype._componentDidMount =\n      WrappedComponent.prototype.componentDidMount\n    WrappedComponent.prototype.componentDidMount = function componentDidMount() {\n      nextTick(() => WrappedComponent.prototype._componentDidMount.call(this))\n    }\n  }\n\n  if (isFunction(forwardRef)) {\n    const ForwardedRefHOC = forwardRef((props, ref) => (\n      <HOC {...props} forwardedRef={ref} />\n    ))\n\n    return hoistStatics(ForwardedRefHOC, WrappedComponent)\n  } else {\n    return hoistStatics(HOC, WrappedComponent)\n  }\n}\n\nconst useActivation = (funcName, func) => {\n  // 兼容性判断\n  if ([useRef, useContext, useEffect].some((fn) => !isFunction(fn))) {\n    return\n  }\n\n  const ctxValue = useContext(aliveNodeContext)\n\n  // 未处于 KeepAlive 中\n  if (!ctxValue) {\n    return\n  }\n\n  const { current: ref } = useRef({})\n  const { attach } = ctxValue\n\n  ref[funcName] = func\n  ref.drop = attach(ref)\n\n  useEffect(() => {\n    return () => run(ref.drop)\n  }, [])\n}\n\nexport const useActivate = useActivation.bind(null, LIFECYCLE_ACTIVATE)\nexport const useUnactivate = useActivation.bind(null, LIFECYCLE_UNACTIVATE)\n","import React, { PureComponent, Suspense } from 'react'\nimport { flushSync } from 'react-dom'\nimport { get, run, nextTick, EventBus } from 'szfe-tools'\n\nimport ReactFreeze from './Freeze'\nimport Bridge from './Bridge'\nimport { AliveNodeProvider } from './context'\nimport { LIFECYCLE_ACTIVATE, LIFECYCLE_UNACTIVATE } from './lifecycles'\n\nconst Freeze = !!Suspense ? ReactFreeze : ({ children }) => children\n\nexport default class Keeper extends PureComponent {\n  eventBus = new EventBus()\n  listeners = new Map()\n  wrapper = null\n\n  constructor(props, ...rest) {\n    super(props, ...rest)\n\n    this.state = {\n      children: props.children,\n      bridgeProps: props.bridgeProps,\n      key: Math.random(),\n      freeze: false,\n    }\n  }\n\n  cache = undefined\n  componentDidMount() {\n    const { store, id } = this.props\n    const listeners = this.listeners\n    const node = this.wrapper\n\n    // 已存在检测，防止意外现象\n    if (store.has(id)) {\n      return\n    }\n\n    let nodes\n    try {\n      nodes = [...node.children]\n    } catch (e) {\n      nodes = [node.children]\n    }\n\n    this.cache = {\n      listeners,\n      aliveNodesId: [],\n      inited: false,\n      cached: false,\n      wrapper: node,\n      nodes,\n      [LIFECYCLE_ACTIVATE]: () => this[LIFECYCLE_ACTIVATE](),\n      [LIFECYCLE_UNACTIVATE]: () => this[LIFECYCLE_UNACTIVATE](),\n    }\n\n    store.set(id, this.cache)\n  }\n\n  \n  unmounted = false\n  safeSetState = (nextState, callback) => {\n    // fix #170\n    if (this.unmounted) {\n      return\n    }\n    this.setState(nextState, callback)\n  }\n  componentWillUnmount() {\n    const { store, keepers, id } = this.props\n    // 卸载前尝试归位 DOM 节点\n    try {\n      const cache = store.get(id)\n      cache.nodes.forEach((node) => {\n        cache.wrapper.appendChild(node)\n      })\n    } catch (error) {\n      // console.error(error) // do nothing\n    }\n    store.delete(id)\n    keepers.delete(id)\n    this.unmounted = true\n  }\n\n  freezeTimeout = null\n\n  ;[LIFECYCLE_ACTIVATE]() {\n    clearTimeout(this.freezeTimeout)\n    // 激活后，立即解冻\n    this.safeSetState({\n      freeze: false,\n    })\n    this.eventBus.emit(LIFECYCLE_ACTIVATE)\n    this.listeners.forEach((listener) => run(listener, [LIFECYCLE_ACTIVATE]))\n  }\n\n  ;[LIFECYCLE_UNACTIVATE]() {\n    this.eventBus.emit(LIFECYCLE_UNACTIVATE)\n    const listeners = [...this.listeners]\n\n    listeners\n      .reverse()\n      .forEach(([, listener]) => run(listener, [LIFECYCLE_UNACTIVATE]))\n\n    // 缓存后，延迟冻结，保证各项后续处理得以进行，如关闭弹窗等\n    clearTimeout(this.freezeTimeout)\n    this.freezeTimeout = setTimeout(() => {\n      flushSync(() => {\n        this.safeSetState({\n          freeze: true,\n        })\n      })\n    }, 1000)\n  }\n\n  // // 原先打算更新过程中先重置 dom 节点状态，更新后恢复 dom 节点\n  // // 但考虑到性能消耗可能过大，且可能因 dom 操作时机引发其他 react 渲染问题，故不使用\n  // // 对应 KeepAlive 处 update 也注释起来不使用\n  // // 组件更新后，更新 DOM 节点列表状态\n  // componentDidUpdate() {\n  //   const { store, id } = this.props\n  //   const node = this.wrapper\n  //   if (get(node, 'children.length') > 0) {\n  //     store[id].nodes = [...node.children]\n  //   }\n\n  //   console.log(store[id].nodes)\n  // }\n\n  // 生命周期绑定\n  attach = (ref) => {\n    const listeners = this.listeners\n\n    if (!ref) {\n      return () => null\n    }\n\n    if (ref.isKeepAlive) {\n      nextTick(() => {\n        const { id, store } = this.props\n        const cache = store.get(id)\n        cache.aliveNodesId = new Set([...cache.aliveNodesId, ref.id])\n      })\n    }\n\n    listeners.set(ref, {\n      [LIFECYCLE_ACTIVATE]: () => run(ref, LIFECYCLE_ACTIVATE),\n      [LIFECYCLE_UNACTIVATE]: () => run(ref, LIFECYCLE_UNACTIVATE),\n    })\n\n    // 返回 listenerRemover 用以在对应组件卸载时解除监听\n    return () => {\n      listeners.delete(ref)\n    }\n  }\n\n  // 静态化节点上下文内容，防止重复渲染\n  contextValue = {\n    id: this.props.id,\n    attach: this.attach,\n  }\n\n  drop = ({ delay = 1200 } = {}) =>\n    new Promise((resolve) => {\n      let timeout\n      const { scope, id } = this.props\n      const drop = () => {\n        clearTimeout(timeout)\n        this.eventBus.off(LIFECYCLE_UNACTIVATE, drop)\n        // 用在多层 KeepAlive 同时触发 drop 时，避免触发深层 KeepAlive 节点的缓存生命周期\n        this.cache.willDrop = true\n        scope.nodes.delete(id)\n        scope.helpers = { ...scope.helpers }\n        scope.smartForceUpdate(() => resolve(true))\n      }\n\n      const canDrop = get(this.cache, 'cached') || get(this.cache, 'willDrop')\n      if (!canDrop) {\n        this.eventBus.on(LIFECYCLE_UNACTIVATE, drop)\n        timeout = setTimeout(() => {\n          this.eventBus.off(LIFECYCLE_UNACTIVATE, drop)\n          resolve(false)\n        }, delay)\n        return\n      }\n\n      drop()\n    })\n\n  refresh = () =>\n    new Promise((resolve) => {\n      const canRefresh = !get(this.cache, 'cached')\n      if (!canRefresh) {\n        resolve(false)\n      }\n      this.safeSetState(\n        {\n          key: Math.random(),\n        },\n        () => resolve(true)\n      )\n    })\n\n  render() {\n    const { id, autoFreeze = true, ...props } = this.props\n    const { children, bridgeProps, key, freeze } = this.state\n\n    return (\n      <Freeze freeze={autoFreeze && freeze}>\n        <div\n          ref={(node) => {\n            this.wrapper = node\n          }}\n        >\n          <div key=\"keeper-container\" nodeKeyIgnore className=\"ka-content\">\n            <Bridge id={id} bridgeProps={bridgeProps}>\n              <AliveNodeProvider value={this.contextValue}>\n                {React.Children.map(children, (child, idx) =>\n                  React.cloneElement(child, {\n                    key: `${child.key || ''}:${key}:${idx}`,\n                  })\n                )}\n              </AliveNodeProvider>\n            </Bridge>\n          </div>\n        </div>\n      </Freeze>\n    )\n  }\n}\n","import React, { Component } from 'react'\nimport { get, run, flatten, debounce, globalThis as root } from 'szfe-tools'\n\nimport { isRegExp } from '../helpers/is'\nimport { AliveScopeProvider } from './context'\nimport Keeper from './Keeper'\n\nconst HANDLE_TYPE_DROP = 'drop'\nconst HANDLE_TYPE_REFRESH = 'refresh'\n\nexport default class AliveScope extends Component {\n  store = new Map()\n  nodes = new Map()\n  keepers = new Map()\n\n  debouncedForceUpdate = debounce((cb) => this.forceUpdate(cb))\n  updateCallbackList = []\n  smartForceUpdate = (cb) => {\n    this.updateCallbackList.push(cb)\n    this.debouncedForceUpdate(() => {\n      this.updateCallbackList.forEach((cb) => run(cb))\n      this.updateCallbackList = []\n    })\n  }\n  update = (id, params) =>\n    new Promise((resolve) => {\n      const keeper = this.keepers.get(id)\n      const isNew = !keeper\n      const now = Date.now()\n      const node = this.nodes.get(id) || null\n      this.nodes.set(id, {\n        id,\n        createTime: now,\n        updateTime: now,\n        ...node,\n        ...params,\n      })\n\n      if (isNew) {\n        this.helpers = { ...this.helpers }\n\n        this.forceUpdate(resolve)\n      } else {\n        const { children, bridgeProps } = params\n        keeper.setState({ children, bridgeProps }, resolve)\n      }\n    })\n\n  keep = (id, params) =>\n    new Promise((resolve) => {\n      this.update(id, {\n        id,\n        ...params,\n      }).then(() => {\n        resolve(this.store.get(id))\n      })\n    })\n\n  getCachingNodesByName = (name) =>\n    this.getCachingNodes().filter((node) =>\n      isRegExp(name) ? name.test(node.name) : node.name === name\n    )\n\n  getScopeIds = (ids) => {\n    // 递归采集 scope alive nodes id\n    const getCachingNodesId = (id) => {\n      const aliveNodesId = get(this.getCache(id), 'aliveNodesId', [])\n\n      if (aliveNodesId.size > 0) {\n        return [id, [...aliveNodesId].map(getCachingNodesId)]\n      }\n\n      return [id, ...aliveNodesId]\n    }\n\n    return flatten(ids.map((id) => getCachingNodesId(id)))\n  }\n\n  dropById = (id, ...rest) => this.handleNodes([id], HANDLE_TYPE_DROP, ...rest)\n  dropScopeByIds = (ids, ...rest) =>\n    this.handleNodes(this.getScopeIds(ids), HANDLE_TYPE_DROP, ...rest)\n\n  drop = (name, ...rest) =>\n    this.handleNodes(\n      this.getCachingNodesByName(name).map((node) => node.id),\n      HANDLE_TYPE_DROP,\n      ...rest\n    )\n\n  dropScope = (name, ...rest) =>\n    this.dropScopeByIds(\n      this.getCachingNodesByName(name).map(({ id }) => id),\n      ...rest\n    )\n\n  refreshById = (id, ...rest) =>\n    this.handleNodes([id], HANDLE_TYPE_REFRESH, ...rest)\n  refreshScopeByIds = (ids, ...rest) =>\n    this.handleNodes(this.getScopeIds(ids), HANDLE_TYPE_REFRESH, ...rest)\n\n  refresh = (name, ...rest) =>\n    this.handleNodes(\n      this.getCachingNodesByName(name).map((node) => node.id),\n      HANDLE_TYPE_REFRESH,\n      ...rest\n    )\n\n  refreshScope = (name, ...rest) =>\n    this.refreshScopeByIds(\n      this.getCachingNodesByName(name).map(({ id }) => id),\n      ...rest\n    )\n\n  handleNodes = (nodesId, type = HANDLE_TYPE_DROP, ...rest) =>\n    new Promise((resolve) => {\n      const handleKeepers = []\n\n      nodesId.forEach((id) => {\n        const cache = this.store.get(id)\n\n        if (!cache) {\n          return\n        }\n\n        const keeper = this.keepers.get(id)\n        handleKeepers.push(keeper)\n      })\n\n      if (handleKeepers.length === 0) {\n        resolve(false)\n        return\n      }\n\n      Promise.all(\n        handleKeepers.map((keeper) => run(keeper, type, ...rest))\n      ).then((responses) => resolve(responses.every(Boolean)))\n    })\n\n  clear = (...rest) =>\n    this.handleNodes(\n      this.getCachingNodes().map(({ id }) => id),\n      HANDLE_TYPE_DROP,\n      ...rest\n    )\n\n  getCache = (id) => this.store.get(id)\n  getNode = (id) => this.nodes.get(id)\n  getCachingNodes = () => [...this.nodes.values()]\n\n  // 静态化节点上下文内容，防止重复渲染\n  helpers = {\n    keep: this.keep,\n    update: this.update,\n    drop: this.drop,\n    dropScope: this.dropScope,\n    dropById: this.dropById,\n    dropScopeByIds: this.dropScopeByIds,\n    refresh: this.refresh,\n    refreshScope: this.refreshScope,\n    refreshById: this.refreshById,\n    refreshScopeByIds: this.refreshScopeByIds,\n    getScopeIds: this.getScopeIds,\n    clear: this.clear,\n    getCache: this.getCache,\n    getNode: this.getNode,\n    getCachingNodes: this.getCachingNodes,\n  }\n\n  render() {\n    const { children = null } = this.props\n\n    return (\n      <AliveScopeProvider value={this.helpers}>\n        {children}\n        <div style={{ display: 'none' }}>\n          {[...this.nodes.values()].map(({ children, ...props }) => (\n            <Keeper\n              key={props.id}\n              {...props}\n              scope={this}\n              store={this.store}\n              keepers={this.keepers}\n              ref={(keeper) => {\n                this.keepers.set(props.id, keeper)\n              }}\n            >\n              {children}\n            </Keeper>\n          ))}\n        </div>\n      </AliveScopeProvider>\n    )\n  }\n}\n","/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { forwardRef, useContext } from 'react'\nimport hoistStatics from 'hoist-non-react-statics'\nimport { get, isFunction, isUndefined } from 'szfe-tools'\n\nimport { Acceptor } from './Bridge'\nimport NodeKey from './NodeKey'\nimport { AliveScopeConsumer, useScopeContext } from './context'\n\nfunction controllerCherryPick(controller) {\n  const {\n    drop,\n    dropScope,\n    refresh,\n    refreshScope,\n    clear,\n    getCachingNodes,\n  } = controller\n  return { drop, dropScope, refresh, refreshScope, clear, getCachingNodes }\n}\n\nexport const expandKeepAlive = (KeepAlive) => {\n  const renderContent = ({ idPrefix, helpers, props }) => {\n    const isOutsideAliveScope = isUndefined(helpers)\n\n    if (isOutsideAliveScope) {\n      console.error('You should not use <KeepAlive /> outside a <AliveScope>')\n    }\n\n    return isOutsideAliveScope ? (\n      get(props, 'children', null)\n    ) : (\n      <NodeKey prefix={idPrefix} key={props._nk} manualKey={props.cacheKey}>\n        {(nkId) => {\n          const id = props.cacheKey || nkId\n\n          return (\n            <Acceptor key={id} id={id}>\n              {(bridgeProps) => (\n                <KeepAlive\n                  key={id}\n                  {...props}\n                  {...bridgeProps}\n                  id={id}\n                  _helpers={helpers}\n                />\n              )}\n            </Acceptor>\n          )\n        }}\n      </NodeKey>\n    )\n  }\n  const HookExpand = ({ id: idPrefix, ...props }) =>\n    renderContent({ idPrefix, helpers: useScopeContext(), props })\n\n  const WithExpand = ({ id: idPrefix, ...props }) => (\n    <AliveScopeConsumer>\n      {(helpers) => renderContent({ idPrefix, helpers, props })}\n    </AliveScopeConsumer>\n  )\n\n  return isFunction(useContext) ? HookExpand : WithExpand\n}\n\nconst withAliveScope = (WrappedComponent) => {\n  const renderContent = ({ helpers, props, forwardedRef }) => (\n    <WrappedComponent {...props} {...helpers} ref={forwardedRef} />\n  )\n\n  const HookScope = ({ forwardedRef, ...props }) =>\n    renderContent({\n      helpers: controllerCherryPick(useScopeContext() || {}),\n      props,\n      forwardedRef,\n    })\n\n  const WithScope = ({ forwardedRef, ...props }) => (\n    <AliveScopeConsumer>\n      {(controller = {}) =>\n        renderContent({\n          helpers: controllerCherryPick(controller),\n          props,\n          forwardedRef,\n        })\n      }\n    </AliveScopeConsumer>\n  )\n\n  const HOCWithAliveScope = isFunction(useContext) ? HookScope : WithScope\n\n  if (isFunction(forwardRef)) {\n    const ForwardedRefHOC = forwardRef((props, ref) => (\n      <HOCWithAliveScope {...props} forwardedRef={ref} />\n    ))\n\n    return hoistStatics(ForwardedRefHOC, WrappedComponent)\n  } else {\n    return hoistStatics(HOCWithAliveScope, WrappedComponent)\n  }\n}\n\nexport const useAliveController = () => {\n  if (!isFunction(useContext)) {\n    return {}\n  }\n\n  const ctxValue = useScopeContext()\n\n  if (!ctxValue) {\n    return {}\n  }\n\n  return controllerCherryPick(ctxValue)\n}\n\nexport default withAliveScope\n","import {\n  globalThis as root,\n  get,\n  run,\n  value,\n  isFunction,\n  isExist,\n  flatten,\n} from 'szfe-tools'\n\nfunction isScrollableNode(node = {}) {\n  if (!isExist(node)) {\n    return false\n  }\n\n  return (\n    node.scrollWidth > node.clientWidth || node.scrollHeight > node.clientHeight\n  )\n}\n\nfunction getScrollableNodes(from) {\n  if (!isFunction(get(root, 'document.querySelectorAll'))) {\n    return []\n  }\n\n  return [...value(run(from, 'querySelectorAll', '*'), []), from].filter(\n    isScrollableNode\n  )\n}\n\nexport default function saveScrollPosition(from) {\n  const nodes = [...new Set([...flatten(from.map(getScrollableNodes))])]\n\n  const saver = nodes.map((node) => [\n    node,\n    {\n      x: node.scrollLeft,\n      y: node.scrollTop,\n    },\n  ])\n\n  return function revert() {\n    saver.forEach(([node, { x, y }]) => {\n      node.scrollLeft = x\n      node.scrollTop = y\n    })\n  }\n}\n","import React, { Component } from 'react'\nimport {\n  value,\n  get,\n  run,\n  globalThis as root,\n  nextTick,\n  isFunction,\n  isArray,\n  debounce,\n  flatten,\n} from 'szfe-tools'\n\nimport { expandKeepAlive } from './withAliveScope'\nimport {\n  LIFECYCLE_ACTIVATE,\n  LIFECYCLE_UNACTIVATE,\n  withActivation,\n} from './lifecycles'\nimport saveScrollPosition from '../helpers/saveScrollPosition'\n\nconst body = get(root, 'document.body')\nconst screenScrollingElement = get(\n  root,\n  'document.scrollingElement',\n  get(root, 'document.documentElement', {})\n)\n\nconst parseWhenResult = (res) => {\n  if (isArray(res)) {\n    return res\n  }\n\n  return [res]\n}\n\nclass KeepAlive extends Component {\n  static defaultProps = {\n    saveScrollPosition: true,\n  }\n\n  id = null // 用作 Keeper 识别 KeepAlive\n  isKeepAlive = true // 用作 Keeper 识别 KeepAlive\n  cached = false\n  constructor(props) {\n    super(props)\n    this.id = props.id\n    this.init()\n\n    // 继承响应父级 KeepAlive 的生命周期\n    ;[LIFECYCLE_ACTIVATE, LIFECYCLE_UNACTIVATE].forEach((lifecycleName) => {\n      this[lifecycleName] = () => {\n        const { id, _helpers } = this.props\n        const cache = _helpers.getCache(id)\n        const node = _helpers.getNode(id)\n        if (node && lifecycleName === LIFECYCLE_ACTIVATE) {\n          node.updateTime = Date.now()\n        }\n\n        const cached = lifecycleName === LIFECYCLE_UNACTIVATE\n\n        // 若组件即将卸载则不再触发缓存生命周期\n        if (!cache || cache.willDrop) {\n          // 若组件在父 KeepAlive 缓存期间被卸载，后续恢复后需重新触发 init\n          if (this.cached && !cached) {\n            this.init()\n          }\n          return\n        }\n\n        run(cache, lifecycleName)\n        cache.cached = cached\n        this.cached = cached\n      }\n    })\n  }\n\n  // DOM 操作将实际内容插入占位元素\n  inject = (didActivate = true) => {\n    const { id, saveScrollPosition, _helpers } = this.props\n    const cache = _helpers.getCache(id)\n    // DOM 操作有风险，try catch 护体\n    try {\n      // // 原计划不增加额外的节点，直接将 Keeper 中所有内容节点一一迁移\n      // // 后发现缺乏统一 react 认可的外层包裹，可能会造成 react dom 操作的错误\n      // // 且将导致 KeepAlive 进行 update 时需先恢复各 dom 节点的组件归属，成本过高\n      // // 故此处增加统一的 div 外层，Keeper 中与 KeepAlive 中各一个且外层不做移除处理\n      // this.parentNode = this.placeholder.parentNode\n      // cache.nodes.forEach(node => {\n      //   this.parentNode.insertBefore(node, this.placeholder)\n      // })\n      // this.parentNode.removeChild(this.placeholder)\n      // 将 AliveScopeProvider 中的渲染内容通过 dom 操作置回当前 KeepAlive\n      cache.nodes.forEach((node) => {\n        this.placeholder.appendChild(node)\n      })\n\n      if (didActivate && saveScrollPosition) {\n        // 恢复该节点下各可滚动元素的滚动位置\n        run(cache.revertScrollPos)\n      }\n    } catch (error) {\n      // console.error(error)\n    }\n  }\n\n  // DOM 操作将实际内容移出占位元素\n  eject = (willUnactivate = true) => {\n    const { id, _helpers } = this.props\n    const cache = _helpers.getCache(id)\n    const nodesNeedToSaveScrollPosition = flatten(\n      flatten([this.props.saveScrollPosition]).map((flag) => {\n        if (flag === true) {\n          return cache.nodes\n        }\n\n        if (flag === 'screen') {\n          return [screenScrollingElement, body]\n        }\n\n        return [...value(run(root, 'document.querySelectorAll', flag), [])]\n      })\n    ).filter(Boolean)\n\n    // DOM 操作有风险，try catch 护体\n    try {\n      if (willUnactivate && nodesNeedToSaveScrollPosition.length > 0) {\n        // 保存该节点下各可滚动元素的滚动位置\n        cache.revertScrollPos = saveScrollPosition(\n          nodesNeedToSaveScrollPosition\n        )\n      }\n\n      // // 原计划不增加额外的节点，直接将 Keeper 中所有内容节点一一迁移\n      // // 后发现缺乏统一 react 认可的外层包裹，可能会造成 react dom 操作的错误\n      // // 且将导致 KeepAlive 进行 update 时需先恢复各 dom 节点的组件归属，成本过高\n      // // 故此处增加统一的 div 外层，Keeper 中与 KeepAlive 中各一个且外层不做移除处理\n      // this.parentNode.insertBefore(this.placeholder, cache.nodes[0])\n      // cache.nodes.forEach(node => {\n      //   if (willUnactivate) {\n      //     this.parentNode.removeChild(node)\n      //   } else {\n      //     cache.wrapper.appendChild(node)\n      //   }\n      // })\n      // this.parentNode.insertBefore(this.placeholder, cache.nodes[0])\n      // 将 KeepAlive 中的节点恢复为原先的占位节点，保证卸载操作正常进行\n      cache.nodes.forEach((node) => {\n        if (willUnactivate) {\n          this.placeholder.removeChild(node)\n        } else {\n          cache.wrapper.appendChild(node)\n        }\n      })\n    } catch (error) {\n      // console.error(error)\n    }\n  }\n\n  init = () => {\n    const { _helpers, id, children, ...rest } = this.props\n\n    // 将 children 渲染至 AliveScopeProvider 中\n    _helpers\n      .keep(id, {\n        children,\n        getInstance: () => this,\n        ...rest,\n      })\n      .then((cache) => {\n        // fix #22\n        if (!cache) {\n          return\n        }\n\n        this.inject()\n\n        // 触发 didActivate 生命周期\n        if (cache.inited) {\n          run(this, LIFECYCLE_ACTIVATE)\n        } else {\n          cache.inited = true\n        }\n        this.cached = false\n      })\n  }\n\n  update = ({ _helpers, id, name, ...rest } = {}) => {\n    if (!_helpers || this.cached) {\n      return\n    }\n\n    // // 原先打算更新过程中先重置 dom 节点状态，更新后恢复 dom 节点\n    // // 但考虑到性能消耗可能过大，且可能因 dom 操作时机引发其他 react 渲染问题，故不使用\n    // // 对应 Keeper 处 componentDidUpdate 也注释起来不使用\n    // this.eject(false)\n    _helpers.update(id, {\n      name,\n      getInstance: () => this,\n      ...rest,\n    })\n    // this.inject(false)\n  }\n\n  // 利用 shouldComponentUpdate 提前触发组件更新\n  shouldComponentUpdate(nextProps) {\n    this.update(nextProps)\n\n    return false\n  }\n\n  // 组件卸载时重置 dom 状态，保证 react dom 操作正常进行，并触发 unactivate 生命周期\n  componentWillUnmount() {\n    const { id, _helpers, when: calcWhen = true } = this.props\n    const cache = _helpers.getCache(id)\n    const [when, isScope] = parseWhenResult(run(calcWhen))\n\n    if (!cache) {\n      return\n    }\n\n    this.eject()\n    delete cache.getInstance\n\n    if (!when) {\n      if (isScope) {\n        const needToDrop = [\n          cache,\n          ..._helpers.getScopeIds([id]).map((id) => _helpers.getCache(id)),\n        ].filter(Boolean)\n\n        needToDrop.forEach((cache) => {\n          cache.willDrop = true\n        })\n        nextTick(() => _helpers.dropScopeByIds([id]))\n      } else {\n        cache.willDrop = true\n        nextTick(() => _helpers.dropById(id))\n      }\n    }\n\n    // 触发 willUnactivate 生命周期\n    run(this, LIFECYCLE_UNACTIVATE)\n  }\n\n  render() {\n    return (\n      <div\n        key=\"keep-alive-placeholder\"\n        nodeKeyIgnore\n        className=\"ka-wrapper\"\n        ref={(node) => {\n          this.placeholder = node\n        }}\n      />\n    )\n  }\n}\n\n// 兼容 SSR 服务端渲染\nfunction SSRKeepAlive({ children }) {\n  return (\n    <div key=\"keep-alive-placeholder\" nodeKeyIgnore className=\"ka-wrapper\">\n      <div key=\"keeper-container\" nodeKeyIgnore className=\"ka-content\">\n        {children}\n      </div>\n    </div>\n  )\n}\n\nexport default isFunction(get(root, 'document.getElementById'))\n  ? expandKeepAlive(withActivation(KeepAlive))\n  : SSRKeepAlive\n"],"names":["isRegExp","val","RegExp","aliveScopeContext","createContext","AliveScopeProvider","Provider","AliveScopeConsumer","Consumer","aliveNodeContext","AliveNodeProvider","AliveNodeConsumer","eventBus","_EventBus","FakeScopeProvider","_Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","currentContextValue","value","_createClass","key","shouldComponentUpdate","nextProps","emit","children","render","Component","_defineProperty","undefined","FakeScopeConsumer","_PureComponent","_super2","_this2","_assertThisInitialized","context","_debounce","nextContextValue","setState","on","updateListener","componentWillUnmount","off","state","_run","PureComponent","_filehash","useScopeContext","_isFunction","useContext","scopeReactContext","_useState","useState","_useState2","_slicedToArray","setContext","useEffect","fakeContextEventBus","_ref","_objectWithoutProperties","_excluded","React","createElement","AliveScopeReactProvider","_extends","_nk","concat","_ref2","AliveScopeReactConsumer","reactContext","Suspender","_len","arguments","length","args","Array","_key","apply","_this$props","freeze","promiseCache","promise","Promise","resolve","Fragment","Freeze","_ref$placeholder","placeholder","Suspense","fallback","fixedContext","updateListenerCache","Map","fixContext","_memoize","ctx","_isExist","includes","ctxValue","push","setTimeout","defaultValue","calculateChangedBits","createReactContext","tryFixCtx","type","_get","override","configs","forEach","_ref3","_toArray","host","methods","slice","method","originMethod","bind","_isString","_overridden","autoFixContext","_len2","_key2","err","console","warn","ProviderBridge","ctxValues","_possibleConstructorReturn","_ctxValues","_ctxValues$","onUpdate","unmount","propCtxValues","filter","Boolean","_ctxValues2","restValues","nextChildren","_isUndefined","ConsumerWrapper","id","get","fn","ctxInfo","updator","set","_objectSpread","prevValue","shouldUpdate","_this$props2","renderWrapper","renderContent","ctx$$","_toConsumableArray","fixedContextSnapshot","RecursiveConsumerBridge","renderChildren","reduce","isSupported","lazy","SusNotSupported","Lazy","FallbackListener","componentDidMount","SuspenseBridge","sus$$","onStart","onSuspenseStart","onEnd","onSuspenseEnd","LazyBridge","_Component2","suspense","ErrorBoundaryBridge","componentDidCatch","error","throwError","error$$","ErrorThrower","cb","Bridge","bridgeProps","Acceptor","ConsumerBridge","LIFECYCLE_ACTIVATE","LIFECYCLE_UNACTIVATE","withActivation","WrappedComponent","HOC","drop","forwardedRef","attach","ref","every","lifecycleName","_isObject","current","prototype","_componentDidMount","_this3","_nextTick","forwardRef","ForwardedRefHOC","hoistStatics","useActivation","funcName","func","useRef","some","_useRef","useActivate","useUnactivate","ReactFreeze","Keeper","rest","nextState","callback","unmounted","_listeners$set","listeners","isKeepAlive","store","cache","aliveNodesId","Set","_ref2$delay","delay","timeout","scope","clearTimeout","willDrop","nodes","helpers","smartForceUpdate","canDrop","canRefresh","safeSetState","Math","random","_this$cache","_this$props3","node","wrapper","has","e","inited","cached","_this$props4","keepers","appendChild","freezeTimeout","listener","reverse","_ref4","flushSync","_this4","_this$props5","_this$props5$autoFree","autoFreeze","_this$state","className","contextValue","Children","map","child","idx","cloneElement","HANDLE_TYPE_DROP","HANDLE_TYPE_REFRESH","AliveScope","forceUpdate","updateCallbackList","debouncedForceUpdate","params","keeper","isNew","now","Date","createTime","updateTime","update","then","name","getCachingNodes","test","ids","getCachingNodesId","getCache","size","_flatten","handleNodes","_len3","_key3","getScopeIds","_len4","_key4","getCachingNodesByName","_this5","_len5","_key5","dropScopeByIds","_this6","_len6","_key6","_this7","_len7","_key7","_this8","_len8","_key8","_this9","_len9","_key9","refreshScopeByIds","nodesId","_len10","_key10","handleKeepers","all","responses","_this10","_len11","_key11","values","keep","dropScope","dropById","refresh","refreshScope","refreshById","clear","getNode","_this11","_this$props$children","style","display","controllerCherryPick","controller","expandKeepAlive","KeepAlive","idPrefix","isOutsideAliveScope","NodeKey","prefix","manualKey","cacheKey","nkId","_helpers","HookExpand","WithExpand","_excluded2","withAliveScope","HookScope","_ref5","_excluded3","WithScope","_ref6","_excluded4","HOCWithAliveScope","useAliveController","isScrollableNode","scrollWidth","clientWidth","scrollHeight","clientHeight","getScrollableNodes","from","_globalThis","_value","saveScrollPosition","saver","x","scrollLeft","y","scrollTop","revert","_ref2$","body","screenScrollingElement","parseWhenResult","res","_isArray","didActivate","revertScrollPos","willUnactivate","nodesNeedToSaveScrollPosition","flag","removeChild","getInstance","inject","init","_this$props5$when","when","calcWhen","_parseWhenResult","_parseWhenResult2","isScope","eject","needToDrop","SSRKeepAlive"],"mappings":"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"}